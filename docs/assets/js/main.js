"use strict";const searchButtonEl=document.querySelector(".search__button"),searchInputEl=document.querySelector(".search__input"),searchResponseEl=document.querySelector(".results-list"),favoriteSectionEl=document.querySelector(".favorite-list");let search="",favorites=[];function favoriteCloseButton(e){const t=e.currentTarget.parentElement.dataset.id,s=favorites.findIndex(e=>e.id===t);favorites.splice(s,1),localStorage.setItem("favorites",JSON.stringify(favorites)),e.currentTarget.parentElement.remove(),document.getElementById(`${t}`).classList.remove("results-section__card--selected")}if(localStorage.favorites){favorites=JSON.parse(localStorage.getItem("favorites"));for(const e of favorites){const t=document.createElement("li");t.classList.add("favorite");const s=document.createElement("h2");s.classList.add("favorite__title");const a=document.createTextNode(e.name);s.appendChild(a);const r=document.createElement("img");r.setAttribute("style",`background-image: ${e.img}`),r.classList.add("favorite__image"),t.appendChild(s),t.appendChild(r),t.setAttribute("data-id",e.id),favoriteSectionEl.appendChild(t);const i=document.createElement("i");i.classList.add("fas"),i.classList.add("fa-times"),i.classList.add("fa-sm"),i.classList.add("favorite-erase"),t.appendChild(i),i.addEventListener("click",favoriteCloseButton)}}function cardClickFavoriteHandler(e){if(!1===e.currentTarget.classList.contains("results-section__card--selected")){e.currentTarget.classList.add("results-section__card--selected");const t=document.createElement("li");t.classList.add("favorite");const s=document.createElement("h2");s.classList.add("favorite__title");const a=document.createTextNode(e.currentTarget.firstChild.innerHTML);s.appendChild(a);const r=document.createElement("img");r.setAttribute("style",`background-image: ${e.currentTarget.firstChild.nextElementSibling.style.backgroundImage}`),r.classList.add("favorite__image");const i=document.createElement("i");i.classList.add("fas"),i.classList.add("fa-times"),i.classList.add("favorite-erase"),t.appendChild(i),i.addEventListener("click",favoriteCloseButton),t.appendChild(s),t.appendChild(r),t.setAttribute("data-id",`${e.currentTarget.id}`),favoriteSectionEl.appendChild(t);const c={id:e.currentTarget.id,name:e.currentTarget.firstChild.innerHTML,img:e.currentTarget.firstChild.nextElementSibling.style.backgroundImage};favorites.push(c),localStorage.setItem("favorites",JSON.stringify(favorites))}else if(!0===e.currentTarget.classList.contains("results-section__card--selected")){e.currentTarget.classList.remove("results-section__card--selected");const t=document.getElementById(`${e.currentTarget.id}`),s=favorites.findIndex(e=>e.id===t);favorites.splice(s-1,1),localStorage.setItem("favorites",JSON.stringify(favorites));const a=document.querySelector(`[data-id='${e.currentTarget.id}']`);a&&a.remove()}}function printSeriesTitle(e){const t=document.createElement("li");t.classList.add("results-section__card"),t.setAttribute("id",`${e.id}`);const s=document.querySelectorAll(".favorite");for(const a of s)parseInt(a.dataset.id)===e.id&&t.classList.add("results-section__card--selected");const a=document.createElement("h2"),r=document.createTextNode(e.name);a.appendChild(r),t.appendChild(a),searchResponseEl.appendChild(t),printSeriesImage(t,e)}function printSeriesImage(e,t){const s=document.createElement("img");s.classList.add("results-card__image");null===t.image?s.setAttribute("style","background-image: url(https://via.placeholder.com/210x295/ffffff/666666/?text=TV)"):s.setAttribute("style",`background-image: url(${t.image.medium})`),e.appendChild(s),e.classList.add("results-section__card");const a=document.querySelectorAll(".results-section__card");for(const e of a)e.addEventListener("click",cardClickFavoriteHandler)}function searchSeries(e){fetch(`http://api.tvmaze.com/search/shows?q=${e}`).then(e=>e.json()).then(function(e){searchResponseEl.innerHTML="";const t=document.createElement("h2"),s=document.createTextNode("Resultados");t.appendChild(s);for(const t of e)printSeriesTitle(t.show)})}function searchButtonClickHandler(){searchSeries(search=searchInputEl.value)}searchButtonEl.addEventListener("click",searchButtonClickHandler);